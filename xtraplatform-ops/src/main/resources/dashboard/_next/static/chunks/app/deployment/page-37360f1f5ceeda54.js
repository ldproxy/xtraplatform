(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[374],{548:function(e,t,s){Promise.resolve().then(s.bind(s,7605))},7605:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return k}});var l=s(3827),n=s(8449),r=s(2548),i=s(5600),a=s(9062),c=s(2177),o=s(9539),d=s.n(o),m=s(5744),x=s(2169),u=s(4090),h=s(3702),p=s(594),g=s(4691),f=s(6054),j=s.n(f);s(1209),s(7613);var y=s(7907),v=s(7780),b=s(8403),N=s(7134),w=s(7949),A=s(9275),I=s(2830),E=s(2172);function k(){let e=(0,I.useReloadInterval)(),[t,s]=(0,u.useState)("overview"),[o,f]=(0,u.useState)([]),k=(0,y.useRouter)(),L=(0,y.usePathname)(),[O,S]=(0,u.useState)([{name:"",url:"",apiUrl:[""],id:""}]),[C,F]=(0,u.useState)(""),[U,R]=(0,u.useState)(null),[P,B]=(0,u.useState)(!0),[V,_]=(0,u.useState)({id:"",name:"",apiUrl:[""]}),{entities:D,jobs:H,healthChecks:M,metrics:Z,info:T,values:z,cfg:q,hasError:J,nodesDifferent:W,loadData:Y,errorStatus:G,fetchError:Q}=(0,w.w)(V);(0,u.useEffect)(()=>{P&&O.length>0&&Y().then(()=>B(!1))},[O]),(0,u.useEffect)(()=>{if(!P&&e>0){let t=setInterval(Y,1e3*e);return()=>clearInterval(t)}},[P,e]),(0,u.useEffect)(()=>{E.hB&&((0,N.R_)().then(e=>{S(e),(0,N.nA)(e,F,_)}),(0,N.Ax)(F))},[]),(0,u.useEffect)(()=>{(async()=>{R(await X(M))})()},[M]),(0,u.useEffect)(()=>{let e=Object.values(M).flat().filter(e=>e&&e.name&&e.name.startsWith("app/")).map(e=>{var t,s,l;return{...e,url:(null===(s=e.url)||void 0===s?void 0:null===(t=s.match(/\/\/([^\/]+)/))||void 0===t?void 0:t[1])||"",description:null===(l=e.description)||void 0===l?void 0:l.replaceAll("\n","<br/>"),checked:d()(e.timestamp).format("HH:mm:ss")}}).filter(e=>null!==e);f((0,A.E)(e))},[M]),(0,u.useEffect)(()=>{L&&s(window.location.hash.slice(1)||"overview")},[L]);let K=()=>{let e=Object.keys(W).filter(e=>W[e]);return e.length>0?"Warning: Differences detected in ".concat(e.join(" and ")," across different replicas. This issue is likely temporary."):null},X=async e=>{if(!V||!(Object.keys(V).length>0))return null;{let t=e[V.name],s="";return t&&t.length>0?t.some(e=>"OFFLINE"===e.state||"UNAVAILABLE"===e.state)&&t.some(e=>"AVAILABLE"===e.state)||Object.keys(G).length>0?s="LIMITED":t.every(e=>"AVAILABLE"===e.state)?s="HEALTHY":t.every(e=>"OFFLINE"===e.state)&&(s="OFFLINE"):s="OFFLINE",[{name:V.name,healthStatus:s}]}},$=o.length,ee=z.length,et=D.length,es=(0,b.lY)(D),el=(0,b.Ph)(es),en=[];return H&&H.length>0&&(en=(0,x.b5)(H)),g.ke&&(console.log("Values:",ee),console.log("totalSources:",$),console.log("Jobs",H),console.log("autoRefreshInterval",e),console.log("errorStatusDeployment",G)),(0,l.jsxs)("div",{className:"flex-1 space-y-4 p-8 pt-0",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between space-y-2",children:[(0,l.jsx)("h2",{className:"text-2xl font-semibold tracking-tight",children:"Deployment"}),V&&Object.keys(V).length>0&&Z&&Z.some(e=>Array.isArray(e.metrics)&&e.metrics.some(e=>-1===e.uptime&&-1===e.memory))&&(0,l.jsx)("div",{className:"ml-auto",children:(0,l.jsx)(v.Z,{color:"#123abc",loading:!0,size:20})})]}),(0,l.jsxs)(m.mQ,{value:t,onValueChange:e=>{s(e),""!==C?k.push("".concat(L,"?did=").concat(C,"#").concat(e)):k.push("".concat(L,"#").concat(e))},className:"h-full space-y-6",children:[(0,l.jsx)("div",{className:"space-between flex items-center",children:(0,l.jsxs)(m.dr,{children:[(0,l.jsx)(m.SP,{value:"overview",children:(0,l.jsx)("span",{children:"Overview"})}),(0,l.jsx)(m.SP,{value:"store",children:(0,l.jsx)("span",{children:"Base Health"})}),(0,l.jsx)(m.SP,{value:"jobs",children:(0,l.jsx)("span",{children:"Jobs"})})]})}),K()&&(0,l.jsxs)("div",{className:"flex items-center space-x-2 p-4 bg-yellow-100 border border-yellow-400 text-yellow-700 rounded",children:[(0,l.jsx)(c.LPM,{className:"h-5 w-5"}),(0,l.jsx)("span",{children:K()})]}),Object.keys(G).length>0&&(0,l.jsx)("div",{className:"flex items-center space-x-2 p-4 bg-yellow-100 border border-yellow-400 text-yellow-700 rounded",children:(0,l.jsx)("span",{children:Object.entries(G).map(e=>{let[t,s]=e;return(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(c.LPM,{className:"h-5 w-5 mr-5"}),"Error ",s," fetching data from endpoint ",t,"!"]},t)})})}),Object.values(Q).map((e,t)=>e&&(0,l.jsxs)("div",{className:"flex items-center space-x-2 p-4 bg-red-100 border border-red-400 text-red-700 rounded",children:[(0,l.jsx)(c.LPM,{className:"h-5 w-5"}),(0,l.jsx)("span",{children:e})]},t)),(0,l.jsxs)(m.nU,{value:"overview",children:[(0,l.jsx)("div",{className:"grid gap-4 md:grid-cols-1 lg:grid-cols-1",style:{marginBottom:"10px"},children:V&&Object.keys(V).length>0&&Z.length>0&&T.length>0&&D.length>0&&U&&U.length>0&&(()=>{var e;let t=T&&T.find(e=>e.name===V.name),s=Z&&Z.find(e=>e.name===V.name),n=U&&(null===(e=U.find(e=>e.name===V.name))||void 0===e?void 0:e.healthStatus);g.ke&&console.log("deploymentInfoEntity",t,"deploymentMetricsEntity",s,"deploymentHealthStatusEntity",n);let r=(0,l.jsx)(i.Z,{name:V&&V.name?" ".concat(V.name):"",versions:t&&Array.isArray(t.info)?t.info.filter(e=>"string"==typeof e.version).map(e=>({version:e.version,apiUrl:e.apiUrl})):[],uptimes:s&&Array.isArray(s.metrics)?s.metrics.filter(e=>"number"==typeof e.uptime).map(e=>({uptime:e.uptime,apiUrl:e.apiUrl})):[],memories:s&&Array.isArray(s.metrics)?s.metrics.filter(e=>"number"==typeof e.memory).map(e=>({memory:e.memory,apiUrl:e.apiUrl})):[],healthStatus:n&&"string"==typeof n?n:"",url:t&&Array.isArray(t.info)&&t.info.length>0&&"string"==typeof t.info[0].url?t.info[0].url:"",IconFooter1:(0,h.q)("Clock"),IconFooter2:(0,h.q)("Upload"),IconFooter3:(0,h.q)("Desktop"),className:"hover:bg-gray-100 transition-colors duration-200"},V.id);return"OFFLINE"===n?(0,l.jsx)("div",{children:r},V.id):r})()}),(0,l.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,l.jsx)(r.Z,{main:"Entities",route:"/entities".concat(""!==C?"?did=".concat(C):""),footer:el,total:et,Icon:(0,h.q)("Id")},"Entities"),(0,l.jsx)(r.Z,{main:"Values",route:"/values".concat(""!==C?"?did=".concat(C):""),footer:"\xa0",total:ee,Icon:(0,h.q)("Code")},"Values")]})]}),(0,l.jsx)(m.nU,{value:"store",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Health checks for global components that are used by all entities."}),(0,l.jsx)(p.w,{columns:n.z,data:o})]})}),(0,l.jsx)(m.nU,{value:"jobs",children:en.length>0?en.map(e=>e.sets&&e.sets.length>0&&e.sets.map(t=>{var s,n;return(0,l.jsxs)(u.Fragment,{children:[(0,l.jsx)("div",{className:"grid gap-4 md:grid-cols-1 lg:grid-cols-1",style:{marginBottom:"10px"},children:(0,l.jsx)(a.Z,{entity:t.entity,label:t.label,tilesets:t.details.tileSets,percent:t.percent,startedAt:t.startedAt,updatedAt:t.updatedAt,info:"".concat(t.current,"/").concat(t.total),id:t.id,url:(null===(n=e.url)||void 0===n?void 0:null===(s=n.match(/\/\/([^\/]+)/))||void 0===s?void 0:s[1])||""},t.id)}),(0,l.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4"})]},t.id)})):(0,l.jsx)("span",{children:"Currently No Jobs"})}),(0,l.jsx)(m.nU,{value:"cfg",children:(0,l.jsx)("div",{style:{backgroundColor:"#f5f5f5",borderRadius:"8px",padding:"16px",border:"1px solid lightgray"},children:J?"No results.":0===Object.keys(q).length?(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(v.Z,{color:"#123abc",loading:!0,size:20}),(0,l.jsx)("span",{style:{marginLeft:"5px"},children:"Loading..."})]}):Object.entries(q).map(e=>{let[t,s]=e,n=JSON.stringify(s,null,2),r=j().highlight(n,j().languages.json,"json");return(0,l.jsxs)("div",{style:{display:"flex"},children:[(0,l.jsxs)("span",{children:[t,":"]}),(0,l.jsx)("pre",{dangerouslySetInnerHTML:{__html:r},style:{margin:"0 0 0 10px"}})]},t)})})})]})]})}},2548:function(e,t,s){"use strict";s.d(t,{Z:function(){return o}});var l=s(3827),n=s(8792),r=s(9084),i=s(2177),a=s(5479);let c=e=>{let{footer:t}=e,s=t.includes("/")?t.split("/")[1]:t.includes("OGC_API")?t:null;return(0,l.jsx)(l.Fragment,{children:t?t.split(" ").map((e,t,n)=>"available"!==e||isNaN(Number(n[t-1]))?"limited"!==e||isNaN(Number(n[t-1]))?"unavailable"!==e||isNaN(Number(n[t-1]))?null!==s?(0,l.jsx)(a.C,{variant:"secondary",children:s},s):isNaN(Number(e))||"available"!==n[t+1]&&"unavailable"!==n[t+1]&&"limited"!==n[t+1]?e+" ":null:[(0,l.jsxs)("span",{className:"text-destructive mr-2",style:{display:"flex",alignItems:"center",marginRight:"15px",fontSize:"20px"},title:"".concat(n[t-1]," ").concat(e),children:[(0,l.jsx)(i.xrR,{className:"text-destructive",width:"20px",height:"20px",style:{marginRight:"5px"}},"CheckCircledIcon"),n[t-1]]},t)]:[(0,l.jsxs)("span",{className:"text-warning mr-2",style:{display:"flex",alignItems:"center",marginRight:"15px",fontSize:"20px"},title:"".concat(n[t-1]," ").concat(e),children:[(0,l.jsx)(i.LPM,{className:"text-warning",width:"20px",height:"20px",style:{marginRight:"5px"}},"CheckCircledIcon"),n[t-1]]},t)]:[(0,l.jsxs)("span",{className:"text-success mr-2",style:{display:"flex",alignItems:"center",marginRight:"15px",fontSize:"20px"},title:"".concat(n[t-1]," ").concat(e),children:[(0,l.jsx)(i.NhS,{className:"text-success",width:"20px",height:"20px",style:{marginRight:"5px"}},"CheckCircledIcon"),n[t-1]]},t)]):null})};function o(e){let{header:t,main:s,footer:i,route:a,total:o,Icon:d,...m}=e,x="AVAILABLE"===t||"ACTIVE"===t||"true"===t?"text-success":"LIMITED"===t?"text-warning":"UNAVAILABLE"===t||"false"===t?"text-destructive":"text-blue-700";return(0,l.jsx)(n.default,{href:a||"#",children:(0,l.jsxs)(r.Zb,{className:"shadow-lg hover:bg-gray-100 transition-colors duration-200",style:{height:"140px"},...m,children:[(0,l.jsx)(r.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-0",children:(0,l.jsx)(r.ll,{className:"text-sm font-semibold ".concat(x).concat(t?"":"text-2xl font-bold mb-1"),children:t?(0,l.jsx)("span",{className:"text-1xl font-bold mb-1 inline-block",children:t}):(0,l.jsx)("span",{className:"text-2xl font-bold mb-1 mt-[-20px] inline-block",children:o})})}),(0,l.jsxs)(r.aY,{children:[(0,l.jsxs)("div",{className:"text-2xl font-bold",style:{display:"flex",flexDirection:"row",marginBottom:"5px",alignItems:"center",justifyContent:"flex-start",gap:"10px"},children:[d?(0,l.jsx)(d,{className:"h-6 w-6 text-muted-foreground"}):null,(0,l.jsx)("span",{style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},title:"string"==typeof s?s:"",children:s})]}),(0,l.jsx)("div",{style:{display:"flex",flexWrap:"wrap"},children:(0,l.jsx)("div",{className:"text-xs text-muted-foreground",style:{display:"flex",flexDirection:"row",marginTop:"5px"},children:i?(0,l.jsx)(c,{footer:i}):null})})]})]})})}}},function(e){e.O(0,[310,622,547,682,267,647,721,800,20,600,828,971,69,744],function(){return e(e.s=548)}),_N_E=e.O()}]);