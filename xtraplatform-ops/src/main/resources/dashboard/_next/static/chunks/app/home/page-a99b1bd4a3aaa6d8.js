(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[951],{86:function(e,t,n){Promise.resolve().then(n.bind(n,7750))},7750:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return k}});var s=n(3827),r=n(4090),a=n(7134),l=n(3702),o=n(2177),i=n(2169),c=n(5600),d=n(7780),u=n(7907),m=n(9881),f=n(8886),h=n(1270),x=n(2670),p=n(248),g=n(807),b=n(8196),y=n(1014),N=n(1800),j=n(543),v=n(4691);let I=p.z.object({name:p.z.string().min(1,{message:"Name muss min. 1 Zeichen lang sein."}).max(30,{message:"Username darf max. 30 Zeichen lang sein."}).refine(e=>!/[äöüÄÖÜ]/.test(e),{message:"Username darf keine Umlaute enthalten."}),id:p.z.string().refine(e=>/^\d+$/.test(e),{message:"Id muss eine Zahl sein."}),url:p.z.string().refine(e=>/^[a-zA-Z0-9:.]+$/.test(e),{message:"URL darf nur aus Buchstaben, Zahlen, Doppelpunkten und Punkten bestehen."}),cfg:p.z.string({required_error:"Bitte w\xe4hlen sie eine Konfiguration."})}),w=e=>{let{onSubmit:t}=e,[n,a]=(0,r.useState)(null),[l,o]=(0,r.useState)([]);(0,r.useEffect)(()=>{(0,N.W2)().then(e=>{o(e),v.ke&&console.log("configurations",e)})},[]);let i=(0,x.cI)({resolver:(0,h.F)(I),mode:"onChange",defaultValues:{name:"",id:"",url:""}}),c=async e=>{try{let n=await t(e);n&&(a(n),i.reset())}catch(e){console.error("Fehler beim Absenden des Formulars",e)}};return(0,s.jsxs)(m.cZ,{children:[(0,s.jsxs)(m.fK,{children:[(0,s.jsx)("div",{style:{marginBottom:"15px"},children:(0,s.jsx)(m.$N,{children:"Deployment hinzuf\xfcgen"})}),(0,s.jsx)(y.Z,{})]}),(0,s.jsx)(g.l0,{...i,children:(0,s.jsxs)("form",{onSubmit:i.handleSubmit(c),className:"space-y-8",style:{marginBottom:"25px"},children:[(0,s.jsx)(g.Wi,{control:i.control,name:"name",render:e=>{let{field:t}=e;return(0,s.jsxs)(g.xJ,{children:[(0,s.jsx)(g.lX,{children:"Name"}),(0,s.jsx)(g.NI,{children:(0,s.jsx)(b.I,{placeholder:"Name",...t})}),(0,s.jsx)(g.zG,{})]})}}),(0,s.jsx)(g.Wi,{control:i.control,name:"id",render:e=>{let{field:t}=e;return(0,s.jsxs)(g.xJ,{children:[(0,s.jsx)(g.lX,{children:"ID"}),(0,s.jsx)(g.NI,{children:(0,s.jsx)(b.I,{placeholder:"ID",...t})}),(0,s.jsx)(g.zG,{})]})}}),(0,s.jsx)(g.Wi,{control:i.control,name:"url",render:e=>{let{field:t}=e;return(0,s.jsxs)(g.xJ,{children:[(0,s.jsx)(g.lX,{children:"Url"}),(0,s.jsx)(g.NI,{children:(0,s.jsx)(b.I,{placeholder:"Url",...t})}),(0,s.jsx)(g.zG,{})]})}}),(0,s.jsx)(g.Wi,{control:i.control,name:"cfg",render:e=>{let{field:t}=e;return(0,s.jsxs)(g.xJ,{children:[(0,s.jsxs)(j.Ph,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,s.jsx)(g.NI,{children:(0,s.jsx)(j.i4,{children:(0,s.jsx)(j.ki,{placeholder:"Konfiguration w\xe4hlen..."})})}),(0,s.jsx)(j.Bw,{children:l.map((e,t)=>(0,s.jsx)(j.Ql,{value:e.name,children:e.name},"".concat(t)))})]}),(0,s.jsx)(g.zG,{})]})}}),(0,s.jsx)(f.z,{style:{fontWeight:"bold"},type:"submit",disabled:!i.formState.isValid,children:"Create"})]})}),n&&!n.success?(0,s.jsx)("div",{style:{color:"red"},children:"Ein Fehler ist aufgetreten."}):n&&n.success?(0,s.jsx)("div",{style:{color:"green"},children:"Deployment wurde erfolgreich hinzugef\xfcgt."}):""]})};var F=n(2830),C=n(2172),D=n(7949);function k(){let e=(0,F.useReloadInterval)(),[t,n]=(0,r.useState)([]),[h,x]=(0,r.useState)([{name:"",availableUrlsCount:0}]),[p,g]=(0,r.useState)([{name:"",offlineUrlsCount:0}]),[b,y]=(0,r.useState)(!0),[N,j]=(0,r.useState)(!0),[I,k]=(0,r.useState)(null),[S,E]=(0,r.useState)(null),[M,z]=(0,r.useState)(!1),{healthCecksHomepage:R,infoHomepage:U,loadData:L,errorStatus:O,fetchError:V}=(0,D.w)(void 0,t),Z=(0,u.useRouter)();(0,r.useEffect)(()=>{C._d&&Z.replace("/404")},[Z]),(0,r.useEffect)(()=>{if((0,a.R_)().then(e=>{n(e)}),e>0){let t=setInterval(()=>{(0,a.R_)().then(e=>{n(e)})},1e3*e);return()=>clearInterval(t)}},[e]),(0,r.useEffect)(()=>{},[t]),(0,r.useEffect)(()=>{let e=async()=>{y(!0);try{R&&Object.keys(R).length>0&&_(R)}catch(e){console.error("Ein Fehler ist beim Laden der Daten aufgetreten:",e)}finally{y(!1),j(!1)}};N&&t.length>0&&(async()=>{await L({loadHealthChecksHomepage:!0,loadInfoHomepage:!0}),e()})()},[t,R]),(0,r.useEffect)(()=>{if(!N&&e>0){let t=async()=>{L({loadHealthChecksHomepage:!0,loadInfoHomepage:!0}),R&&Object.keys(R).length>0&&_(R)},n=setInterval(()=>{t()},1e3*e);return()=>clearInterval(n)}},[t,N,e,R]);let _=async e=>{let n=await H(e),s=await (0,i.Sq)(e,t),r=(0,i.CG)(e,t),a=(0,i.fO)(e,t);k(n),x(s),E(r),g(a)},H=async e=>t.length>0?t.map(t=>{let n=e[t.name],s="";return s=n&&n.length>0?t.apiUrl.some(e=>Object.keys(O).includes(e))?"LIMITED":n.every(e=>"AVAILABLE"===e.state)?"HEALTHY":n.every(e=>"OFFLINE"===e.state)?"OFFLINE":"LIMITED":"OFFLINE",{name:t.name,healthStatus:s}}):null,W=async e=>{try{await (0,a.f8)({name:e.name,apiUrl:["http://".concat(e.url,"/api")],url:"http://".concat(e.url,"/deployment"),id:e.id,cfg:e.cfg});let t=await (0,a.R_)();return n(t),{success:!0}}catch(e){return console.error("Fehler beim Erstellen des Deployments",e),{success:!1}}};return(0,s.jsxs)("div",{className:"flex-1 space-y-4 p-8 pt-0",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between space-y-2",children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold tracking-tight",children:"Deployments"}),b&&(0,s.jsx)("div",{className:"ml-auto mr-10",children:(0,s.jsx)(d.Z,{color:"#123abc",loading:!0,size:20})}),C.f2&&(0,s.jsxs)(m.Vq,{onOpenChange:e=>z(e),children:[(0,s.jsxs)(m.hg,{className:(0,f.d)({variant:"default"}),style:{fontWeight:"bold"},children:[(0,s.jsx)(o.SPS,{className:"mr-2 h-4 w-4"}),"Neu"]}),(0,s.jsx)(w,{onSubmit:W})]})]}),(0,s.jsx)("div",{className:"justify-between space-y-2",children:(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-1 lg:grid-cols-1 ",style:{marginBottom:"10px"},children:[Object.values(V).map((e,t)=>e&&(0,s.jsxs)("div",{className:"flex items-center space-x-2 p-4 bg-red-100 border border-red-400 text-red-700 rounded",children:[(0,s.jsx)(o.LPM,{className:"h-5 w-5"}),(0,s.jsx)("span",{children:e})]},t)),t.map((e,t)=>(()=>{var n,r,a,o;let i=U&&U.find(t=>t.name===e.name),d=I&&(null===(n=I.find(t=>t.name===e.name))||void 0===n?void 0:n.healthStatus),u=(null===(r=h.find(t=>t.name===e.name))||void 0===r?void 0:r.availableUrlsCount)||0,m=S&&(null===(a=S.find(t=>t.name===e.name))||void 0===a?void 0:a.availableUrlsCount)||0,f=p&&(null===(o=p.find(t=>t.name===e.name))||void 0===o?void 0:o.offlineUrlsCount)||0;v.CH&&console.log("deploymentInfo",i,"deploymentHealthStatus",d);let x=(0,s.jsx)(c.Z,{name:e.name?" ".concat(e.name):"",url:i&&Array.isArray(i.info)&&i.info.length>0&&"string"==typeof i.info[0].url?i.info[0].url:"",totalNodes:e.apiUrl.length,limitedNodes:u,healthyNodes:m,offlineNodes:f,healthStatus:d&&"string"==typeof d?d:"",IconFooter1:(0,l.q)("InfoCircled"),IconFooter2:(0,l.q)("CheckCircled"),IconFooter3:(0,l.q)("QuestionMark"),IconFooter4:(0,l.q)("Cross"),className:"hover:bg-gray-100 transition-colors duration-200"},t);return"OFFLINE"===d?(0,s.jsx)("div",{children:x},t):(0,s.jsx)("span",{className:"cursor-pointer",onClick:()=>Z.push("/deployment?did=".concat(e.id)),children:x},t)})())]})})]})}},9881:function(e,t,n){"use strict";n.d(t,{$N:function(){return x},Vq:function(){return i},cN:function(){return h},cZ:function(){return m},fK:function(){return f},hg:function(){return c}});var s=n(3827),r=n(4090),a=n(8768),l=n(2235),o=n(2169);let i=a.fC,c=a.xz,d=a.h_;a.x8;let u=r.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,s.jsx)(a.aV,{ref:t,className:(0,o.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",n),...r})});u.displayName=a.aV.displayName;let m=r.forwardRef((e,t)=>{let{className:n,children:r,...i}=e;return(0,s.jsxs)(d,{children:[(0,s.jsx)(u,{}),(0,s.jsxs)(a.VY,{ref:t,className:(0,o.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",n),...i,children:[r,(0,s.jsxs)(a.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(l.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=a.VY.displayName;let f=e=>{let{className:t,...n}=e;return(0,s.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...n})};f.displayName="DialogHeader";let h=e=>{let{className:t,...n}=e;return(0,s.jsx)("div",{className:(0,o.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...n})};h.displayName="DialogFooter";let x=r.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,s.jsx)(a.Dx,{ref:t,className:(0,o.cn)("text-lg font-semibold leading-none tracking-tight",n),...r})});x.displayName=a.Dx.displayName,r.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,s.jsx)(a.dk,{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",n),...r})}).displayName=a.dk.displayName},807:function(e,t,n){"use strict";n.d(t,{l0:function(){return u},NI:function(){return b},Wi:function(){return f},xJ:function(){return p},lX:function(){return g},zG:function(){return y}});var s=n(3827),r=n(4090),a=n(15),l=n(2670),o=n(2169),i=n(6028);let c=(0,n(7742).j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=r.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,s.jsx)(i.f,{ref:t,className:(0,o.cn)(c(),n),...r})});d.displayName=i.f.displayName;let u=l.RV,m=r.createContext({}),f=e=>{let{...t}=e;return(0,s.jsx)(m.Provider,{value:{name:t.name},children:(0,s.jsx)(l.Qr,{...t})})},h=()=>{let e=r.useContext(m),t=r.useContext(x),{getFieldState:n,formState:s}=(0,l.Gc)(),a=n(e.name,s);if(!e)throw Error("useFormField should be used within <FormField>");let{id:o}=t;return{id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message"),...a}},x=r.createContext({}),p=r.forwardRef((e,t)=>{let{className:n,...a}=e,l=r.useId();return(0,s.jsx)(x.Provider,{value:{id:l},children:(0,s.jsx)("div",{ref:t,className:(0,o.cn)("space-y-2",n),...a})})});p.displayName="FormItem";let g=r.forwardRef((e,t)=>{let{className:n,...r}=e,{error:a,formItemId:l}=h();return(0,s.jsx)(d,{ref:t,className:(0,o.cn)(a&&"text-destructive",n),htmlFor:l,...r})});g.displayName="FormLabel";let b=r.forwardRef((e,t)=>{let{...n}=e,{error:r,formItemId:l,formDescriptionId:o,formMessageId:i}=h();return(0,s.jsx)(a.g7,{ref:t,id:l,"aria-describedby":r?"".concat(o," ").concat(i):"".concat(o),"aria-invalid":!!r,...n})});b.displayName="FormControl",r.forwardRef((e,t)=>{let{className:n,...r}=e,{formDescriptionId:a}=h();return(0,s.jsx)("p",{ref:t,id:a,className:(0,o.cn)("text-sm text-muted-foreground",n),...r})}).displayName="FormDescription";let y=r.forwardRef((e,t)=>{let{className:n,children:r,...a}=e,{error:l,formMessageId:i}=h(),c=l?String(null==l?void 0:l.message):r;return c?(0,s.jsx)("p",{ref:t,id:i,className:(0,o.cn)("text-sm font-medium text-destructive",n),...a,children:c}):null});y.displayName="FormMessage"},8196:function(e,t,n){"use strict";n.d(t,{I:function(){return l}});var s=n(3827),r=n(4090),a=n(2169);let l=r.forwardRef((e,t)=>{let{className:n,type:r,...l}=e;return(0,s.jsx)("input",{type:r,className:(0,a.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),ref:t,...l})});l.displayName="Input"},6311:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});let s=e=>Number.isFinite(e)?e:0,r=e=>0===e||0n===e,a=(e,t)=>1===t||1n===t?e:"".concat(e,"s"),l=24n*60n*60n*1000n;function o(e,t){let n="bigint"==typeof e;if(!n&&!Number.isFinite(e))throw TypeError("Expected a finite number or bigint");(t={...t}).colonNotation&&(t.compact=!1,t.formatSubMilliseconds=!1,t.separateMilliseconds=!1,t.verbose=!1),t.compact&&(t.unitCount=1,t.secondsDecimalDigits=0,t.millisecondsDecimalDigits=0);let o=[],i=(e,n,s,l)=>{if(!((0===o.length||!t.colonNotation)&&r(e))||t.colonNotation&&"m"===s){if(l=null!=l?l:String(e),t.colonNotation){let e=l.includes(".")?l.split(".")[0].length:l.length,t=o.length>0?2:1;l="0".repeat(Math.max(0,t-e))+l}else l+=t.verbose?" "+a(n,e):s;o.push(l)}},c=function(e){switch(typeof e){case"number":if(Number.isFinite(e))return{days:Math.trunc(e/864e5),hours:Math.trunc(e/36e5%24),minutes:Math.trunc(e/6e4%60),seconds:Math.trunc(e/1e3%60),milliseconds:Math.trunc(e%1e3),microseconds:Math.trunc(s(1e3*e)%1e3),nanoseconds:Math.trunc(s(1e6*e)%1e3)};break;case"bigint":return{days:e/86400000n,hours:e/3600000n%24n,minutes:e/60000n%60n,seconds:e/1000n%60n,milliseconds:e%1000n,microseconds:0n,nanoseconds:0n}}throw TypeError("Expected a finite number or bigint")}(e),d=BigInt(c.days);if(i(d/365n,"year","y"),i(d%365n,"day","d"),i(Number(c.hours),"hour","h"),i(Number(c.minutes),"minute","m"),t.separateMilliseconds||t.formatSubMilliseconds||!t.colonNotation&&e<1e3){let e=Number(c.seconds),n=Number(c.milliseconds),s=Number(c.microseconds),r=Number(c.nanoseconds);if(i(e,"second","s"),t.formatSubMilliseconds)i(n,"millisecond","ms"),i(s,"microsecond","\xb5s"),i(r,"nanosecond","ns");else{let e=n+s/1e3+r/1e6,a="number"==typeof t.millisecondsDecimalDigits?t.millisecondsDecimalDigits:0,l=a?e.toFixed(a):e>=1?Math.round(e):Math.ceil(e);i(Number.parseFloat(l),"millisecond","ms",l)}}else{var u;let s=(Math.round(Math.floor((n?Number(e%l):e)/1e3%60*10**(u="number"==typeof t.secondsDecimalDigits?t.secondsDecimalDigits:1)+1e-7))/10**u).toFixed(u),r=t.keepDecimalsOnWholeSeconds?s:s.replace(/\.0+$/,"");i(Number.parseFloat(r),"second","s",r)}if(0===o.length)return"0"+(t.verbose?" milliseconds":"ms");let m=t.colonNotation?":":" ";return"number"==typeof t.unitCount&&(o=o.slice(0,Math.max(t.unitCount,1))),o.join(m)}}},function(e){e.O(0,[310,622,547,682,950,800,20,600,971,69,744],function(){return e(e.s=86)}),_N_E=e.O()}]);