(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[58],{9476:function(e,t,l){Promise.resolve().then(l.bind(l,767))},767:function(e,t,l){"use strict";l.r(t);var s=l(3827),a=l(4090),n=l(2169),i=l(2177),r=l(4691),o=l(8449),d=l(594),c=l(7907),u=l(7780),m=l(9062),h=l(9275),x=l(7949),f=l(2830),p=l(1800),g=l(5744),j=l(6054),b=l.n(j);l(1209),l(7613);var v=l(9539),y=l.n(v),N=l(2172);function w(){let e=(0,f.useReloadInterval)(),t=(0,c.useRouter)(),[l,j]=(0,a.useState)(void 0),[v,w]=(0,a.useState)({}),[S,C]=(0,a.useState)(!0),[R,k]=(0,a.useState)([]),[_,E]=(0,a.useState)("overview"),[H,M]=(0,a.useState)(!1),[T,L]=(0,a.useState)(!1),{healthChecksEntities:F,entities:A,jobs:D,loadData:I}=(0,x.w)(),O="",P=(0,c.useSearchParams)();null!==P&&(O=P.get("id")),(0,a.useEffect)(()=>{O&&L(O.endsWith("tiles"))},[O]),(0,a.useEffect)(()=>{if(O&&A){let e=A.find(e=>e.uid===O);j(e),r.Dh&&(console.log("newEntities",A),console.log("myEntity",e))}},[O,A]),(0,a.useEffect)(()=>{if(F&&F.length>0&&l){let e=F.filter(e=>e.name==="entities/".concat(l.type,"/").concat(l.id)).flatMap(e=>e.capabilities?e.capabilities.map(t=>({...t,timestamp:e.timestamp,url:e.url,components:e.components?e.components.filter(e=>e.capabilities.includes(t.name)).map(e=>({...e,capability:t.name,component:!0})):[]})):[]).map(e=>{var t,l,s;return{...e,url:(null===(l=e.url)||void 0===l?void 0:null===(t=l.match(/\/\/([^\/]+)/))||void 0===t?void 0:t[1])||"",description:null===(s=e.description)||void 0===s?void 0:s.replaceAll("\n","<br/>"),checked:y()(e.timestamp).format("HH:mm:ss")}}).filter(e=>null!==e),t=N.hB?(0,h.E)(e):e;k(t),r.Dh&&console.log("myCheck:",e,t)}},[F,l]);let J=async()=>{try{if(null!==O){let e=await (0,p.ZH)(O);"Method not allowed"===e.message?M(!0):w(e)}}catch(e){console.error("Error loading cfg:",e),M(!0)}};(0,a.useEffect)(()=>{let t=async()=>{N.f2&&await J(),I({loadEntities:!0,loadHealthChecksEntities:!0,loadJobs:!0}),C(!1),r.Dh&&(console.log("entities[id]",A),console.log("entity[id]",l),console.log("cfg",v))};if(t(),e>0){let l=setInterval(()=>{t(),I({loadEntities:!0,loadHealthChecksEntities:!0,loadJobs:!0})},1e3*e);return()=>clearInterval(l)}},[T,e]);let V=[];return(D.length>0&&(V=(0,n.b5)(D)),S)?(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(u.Z,{color:"#123abc",loading:!0,size:20}),(0,s.jsx)("span",{style:{marginLeft:"10px"},children:"Loading..."})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex justify-between items-center",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("a",{onClick:()=>t.back(),className:"font-bold flex items-center cursor-pointer text-blue-500 hover:text-blue-400",children:(0,s.jsx)(i.wyc,{className:"mr-[-1px] h-6 w-6"})}),(0,s.jsx)("h2",{className:"text-2xl font-semibold tracking-tight ml-2",children:l?l.id:"Not Found..."})]})}),(0,s.jsx)("div",{className:"p-8 pt-6",children:(0,s.jsxs)(g.mQ,{value:_,onValueChange:e=>{E(e)},className:"h-full space-y-6",children:[(0,s.jsx)("div",{className:"space-between flex items-center",children:(0,s.jsxs)(g.dr,{children:[(0,s.jsx)(g.SP,{value:"overview",children:(0,s.jsx)("span",{children:"Health"})}),O&&T&&D&&D.length>0&&D.some(e=>e.sets&&e.sets.length>0&&e.sets.some(e=>e.entity===(null==O?void 0:O.split("_").slice(1).join("_"))))&&(0,s.jsx)(g.SP,{value:"jobs",children:(0,s.jsx)("span",{children:"Jobs"})})]})}),(0,s.jsx)(g.nU,{value:"overview",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Health checks for the capabilities of this entity."}),(0,s.jsx)(d.w,{columns:o.z,data:R})]})}),(0,s.jsx)(g.nU,{value:"jobs",children:O&&V.length>0&&V.some(e=>e&&e.sets.length>0&&e.sets.some(e=>e.entity===(null==O?void 0:O.split("_").slice(1).join("_"))))?V.filter(e=>e&&e.sets.some(e=>e.entity===(null==O?void 0:O.split("_").slice(1).join("_")))).map(e=>e.sets.filter(e=>e.entity===(null==O?void 0:O.split("_").slice(1).join("_"))).map(t=>(0,s.jsxs)(a.Fragment,{children:[(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-1 lg:grid-cols-1",style:{marginBottom:"10px"},children:(0,s.jsx)(m.Z,{entity:t.entity,label:t.label,tilesets:t.details.tileSets,percent:t.percent,startedAt:t.startedAt,updatedAt:t.updatedAt,info:"".concat(t.current,"/").concat(t.total),id:t.id,url:e.url},t.id)}),(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4"})]},t.id))):null}),(0,s.jsx)(g.nU,{value:"cfg",children:(0,s.jsx)("div",{style:{backgroundColor:"#f5f5f5",borderRadius:"8px",padding:"16px",border:"1px solid lightgray"},children:H?"No results.":0===Object.keys(v).length?(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(u.Z,{color:"#123abc",loading:!0,size:20}),(0,s.jsx)("span",{style:{marginLeft:"5px"},children:"Loading..."})]}):Object.entries(v).map(e=>{let[t,l]=e,a=JSON.stringify(l,null,2),n=b().highlight(a,b().languages.json,"json");return(0,s.jsxs)("div",{style:{display:"flex"},children:[(0,s.jsxs)("span",{children:[t,":"]}),(0,s.jsx)("pre",{dangerouslySetInnerHTML:{__html:n},style:{margin:"0 0 0 10px"}})]},t)})})})]})})]})}t.default=()=>(0,s.jsx)(a.Suspense,{fallback:(0,s.jsx)("div",{children:"Loading..."}),children:(0,s.jsx)(w,{})})},594:function(e,t,l){"use strict";l.d(t,{w:function(){return x}});var s=l(3827),a=l(4090),n=l(1006),i=l(3280),r=l(2169);let o=a.forwardRef((e,t)=>{let{className:l,...a}=e;return(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:t,className:(0,r.cn)("w-full caption-bottom text-sm",l),...a})})});o.displayName="Table";let d=a.forwardRef((e,t)=>{let{className:l,...a}=e;return(0,s.jsx)("thead",{ref:t,className:(0,r.cn)("[&_tr]:border-b",l),...a})});d.displayName="TableHeader";let c=a.forwardRef((e,t)=>{let{className:l,...a}=e;return(0,s.jsx)("tbody",{ref:t,className:(0,r.cn)("[&_tr:last-child]:border-0",l),...a})});c.displayName="TableBody",a.forwardRef((e,t)=>{let{className:l,...a}=e;return(0,s.jsx)("tfoot",{ref:t,className:(0,r.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",l),...a})}).displayName="TableFooter";let u=a.forwardRef((e,t)=>{let{className:l,...a}=e;return(0,s.jsx)("tr",{ref:t,className:(0,r.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",l),...a})});u.displayName="TableRow";let m=a.forwardRef((e,t)=>{let{className:l,...a}=e;return(0,s.jsx)("th",{ref:t,className:(0,r.cn)("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",l),...a})});m.displayName="TableHead";let h=a.forwardRef((e,t)=>{let{className:l,...a}=e;return(0,s.jsx)("td",{ref:t,className:(0,r.cn)("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",l),...a})});function x(e){var t;let{columns:l,data:r}=e,[x,f]=a.useState({}),[p,g]=a.useState([]),[j,b]=a.useState([]),[v,y]=a.useState({}),N=(0,n.b7)({data:r,columns:l,getCoreRowModel:(0,i.sC)(),onSortingChange:b,getSortedRowModel:(0,i.tj)(),onColumnFiltersChange:g,getFilteredRowModel:(0,i.vL)(),onColumnVisibilityChange:f,getExpandedRowModel:(0,i.rV)(),getSubRows:e=>e.subRows,onExpandedChange:y,state:{sorting:j,columnFilters:p,columnVisibility:x,expanded:v}});return(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"rounded-md border",children:(0,s.jsxs)(o,{children:[(0,s.jsx)(d,{children:N.getHeaderGroups().map(e=>(0,s.jsx)(u,{children:e.headers.map(e=>(0,s.jsx)(m,{children:e.isPlaceholder?null:(0,n.ie)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,s.jsx)(c,{children:(null===(t=N.getRowModel().rows)||void 0===t?void 0:t.length)?N.getRowModel().rows.map(e=>(0,s.jsx)(u,{"data-state":e.getIsSelected()&&"selected",className:"".concat(0===e.depth?"":"bg-muted"),children:e.getVisibleCells().map(e=>(0,s.jsx)(h,{children:(0,n.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,s.jsx)(u,{children:(0,s.jsx)(h,{colSpan:l.length,className:"h-24 text-center",children:"No results."})})})]})})})}h.displayName="TableCell",a.forwardRef((e,t)=>{let{className:l,...a}=e;return(0,s.jsx)("caption",{ref:t,className:(0,r.cn)("mt-4 text-sm text-muted-foreground",l),...a})}).displayName="TableCaption"}},function(e){e.O(0,[310,622,547,682,267,647,721,800,20,828,971,69,744],function(){return e(e.s=9476)}),_N_E=e.O()}]);