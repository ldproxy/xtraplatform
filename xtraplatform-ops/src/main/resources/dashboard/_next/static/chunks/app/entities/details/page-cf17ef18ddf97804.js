(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[58],{9476:function(e,t,l){Promise.resolve().then(l.bind(l,767))},767:function(e,t,l){"use strict";l.r(t);var s=l(3827),r=l(2169),a=l(2177),n=l(7907),i=l(4090),o=l(4691),c=l(8449),d=l(594),m=l(7780),x=l(9062),h=l(9275),u=l(5459),g=l(2830),f=l(1800),p=l(5744),j=l(6054),b=l.n(j);l(1209),l(7613);var v=l(9539),y=l.n(v),w=l(9266),N=l(8403),C=l(2172);function S(){let e=(0,g.useReloadInterval)(),t=(0,n.useRouter)(),[l,j]=(0,i.useState)([]),[v,S]=(0,i.useState)(null),[k,R]=(0,i.useState)({}),[E,z]=(0,i.useState)(!0),[_,T]=(0,i.useState)([]),[H,L]=(0,i.useState)("overview"),[D,F]=(0,i.useState)(!1),[I,M]=(0,i.useState)(!1),{healthChecksEntities:O,jobs:A,loadData:Z}=(0,u.w)(),B="",V=(0,n.useSearchParams)();null!==V&&(B=V.get("id")),(0,i.useEffect)(()=>{B&&M(B.endsWith("tiles"))},[B]),(0,i.useEffect)(()=>{if(O&&O.length>0&&v){let e=O.filter(e=>e.name==="entities/".concat(v.type,"/").concat(v.id)).flatMap(e=>e.capabilities?e.capabilities.map(t=>({...t,timestamp:e.timestamp,url:e.url,components:e.components?e.components.filter(e=>e.capabilities.includes(t.name)).map(e=>({...e,capability:t.name,component:!0})):[]})):[]).map(e=>{if(e&&e.name&&e.url){var t;let l=(null===(t=e.url.match(/\/\/([^\/]+)/))||void 0===t?void 0:t[1])||"";return{name:e.name,label:e.label||"",description:e.description||"",url:l,state:e.state,message:e.message,checked:y()(e.timestamp).format("HH:mm:ss")}}return null}).filter(e=>null!==e),t=C.hB?(0,h.E8)(e):e;T(t),o.Dh&&console.log("myCheck:",e,t)}},[O,v]);let P=async()=>{try{if(null!==B){let e=await (0,f.ZH)(B);"Method not allowed"===e.message?F(!0):R(e)}}catch(e){console.error("Error loading cfg:",e),F(!0)}},J=async()=>{try{let e=await (0,w.r)("/api/entities",N.NT,!0);if(!e)return(0,n.notFound)();j(e);let t=e.find(e=>e.uid===B);S(t),o.Dh&&(console.log("newEntities",e),console.log("myEntity",t))}catch(e){console.error("Error loading entities:",e)}};(0,i.useEffect)(()=>{let t=async()=>{await J(),C.f2&&await P(),Z({loadHealthChecksEntities:!0,loadJobs:!0}),z(!1),o.Dh&&(console.log("entities[id]",l),console.log("entity[id]",v),console.log("cfg",k))};if(t(),e>0){let l=setInterval(()=>{t(),Z({loadHealthChecksEntities:!0,loadJobs:!0})},1e3*e);return()=>clearInterval(l)}},[I,e]);let K=[];return(A.length>0&&(K=(0,r.b5)(A)),E)?(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(m.Z,{color:"#123abc",loading:!0,size:20}),(0,s.jsx)("span",{style:{marginLeft:"10px"},children:"Loading..."})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex justify-between items-center",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("a",{onClick:()=>t.back(),className:"font-bold flex items-center cursor-pointer text-blue-500 hover:text-blue-400",children:(0,s.jsx)(a.wyc,{className:"mr-[-1px] h-6 w-6"})}),(0,s.jsx)("h2",{className:"text-2xl font-semibold tracking-tight ml-2",children:v?v.id:"Not Found..."})]})}),(0,s.jsx)("div",{className:"p-8 pt-6",children:(0,s.jsxs)(p.mQ,{value:H,onValueChange:e=>{L(e)},className:"h-full space-y-6",children:[(0,s.jsx)("div",{className:"space-between flex items-center",children:(0,s.jsxs)(p.dr,{children:[(0,s.jsx)(p.SP,{value:"overview",children:(0,s.jsx)("span",{children:"Health"})}),B&&I&&A&&A.some(e=>e.entity===(null==B?void 0:B.split("_").slice(1).join("_")))&&(0,s.jsx)(p.SP,{value:"jobs",children:(0,s.jsx)("span",{children:"Jobs"})})]})}),(0,s.jsx)(p.nU,{value:"overview",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Health checks for the capabilities of this entity."}),(0,s.jsx)(d.w,{columns:c.z,data:_})]})}),(0,s.jsx)(p.nU,{value:"jobs",children:B&&K.length>0&&K.filter(e=>e.entity===(null==B?void 0:B.split("_").slice(1).join("_"))).length>0?K.filter(e=>e.entity===(null==B?void 0:B.split("_").slice(1).join("_"))).map(e=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-1 lg:grid-cols-1",style:{marginBottom:"10px"},children:(0,s.jsx)(x.Z,{entity:e.entity,label:e.label,tilesets:e.details.tileSets,percent:e.percent,startedAt:e.startedAt,updatedAt:e.updatedAt,info:"".concat(e.current,"/").concat(e.total),id:e.id},e.id)}),(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4"})]})):null}),(0,s.jsx)(p.nU,{value:"cfg",children:(0,s.jsx)("div",{style:{backgroundColor:"#f5f5f5",borderRadius:"8px",padding:"16px",border:"1px solid lightgray"},children:D?"No results.":0===Object.keys(k).length?(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(m.Z,{color:"#123abc",loading:!0,size:20}),(0,s.jsx)("span",{style:{marginLeft:"5px"},children:"Loading..."})]}):Object.entries(k).map(e=>{let[t,l]=e,r=JSON.stringify(l,null,2),a=b().highlight(r,b().languages.json,"json");return(0,s.jsxs)("div",{style:{display:"flex"},children:[(0,s.jsxs)("span",{children:[t,":"]}),(0,s.jsx)("pre",{dangerouslySetInnerHTML:{__html:a},style:{margin:"0 0 0 10px"}})]},t)})})})]})})]})}t.default=()=>(0,s.jsx)(i.Suspense,{fallback:(0,s.jsx)("div",{children:"Loading..."}),children:(0,s.jsx)(S,{})})},594:function(e,t,l){"use strict";l.d(t,{w:function(){return u}});var s=l(3827),r=l(4090),a=l(1006),n=l(3280),i=l(2169);let o=r.forwardRef((e,t)=>{let{className:l,...r}=e;return(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:t,className:(0,i.cn)("w-full caption-bottom text-sm",l),...r})})});o.displayName="Table";let c=r.forwardRef((e,t)=>{let{className:l,...r}=e;return(0,s.jsx)("thead",{ref:t,className:(0,i.cn)("[&_tr]:border-b",l),...r})});c.displayName="TableHeader";let d=r.forwardRef((e,t)=>{let{className:l,...r}=e;return(0,s.jsx)("tbody",{ref:t,className:(0,i.cn)("[&_tr:last-child]:border-0",l),...r})});d.displayName="TableBody",r.forwardRef((e,t)=>{let{className:l,...r}=e;return(0,s.jsx)("tfoot",{ref:t,className:(0,i.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",l),...r})}).displayName="TableFooter";let m=r.forwardRef((e,t)=>{let{className:l,...r}=e;return(0,s.jsx)("tr",{ref:t,className:(0,i.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",l),...r})});m.displayName="TableRow";let x=r.forwardRef((e,t)=>{let{className:l,...r}=e;return(0,s.jsx)("th",{ref:t,className:(0,i.cn)("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",l),...r})});x.displayName="TableHead";let h=r.forwardRef((e,t)=>{let{className:l,...r}=e;return(0,s.jsx)("td",{ref:t,className:(0,i.cn)("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",l),...r})});function u(e){var t;let{columns:l,data:i}=e,[u,g]=r.useState({}),[f,p]=r.useState([]),[j,b]=r.useState([]),[v,y]=r.useState({}),w=(0,a.b7)({data:i,columns:l,getCoreRowModel:(0,n.sC)(),onSortingChange:b,getSortedRowModel:(0,n.tj)(),onColumnFiltersChange:p,getFilteredRowModel:(0,n.vL)(),onColumnVisibilityChange:g,getExpandedRowModel:(0,n.rV)(),getSubRows:e=>e.subRows,onExpandedChange:y,state:{sorting:j,columnFilters:f,columnVisibility:u,expanded:v}});return(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"rounded-md border",children:(0,s.jsxs)(o,{children:[(0,s.jsx)(c,{children:w.getHeaderGroups().map(e=>(0,s.jsx)(m,{children:e.headers.map(e=>(0,s.jsx)(x,{children:e.isPlaceholder?null:(0,a.ie)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,s.jsx)(d,{children:(null===(t=w.getRowModel().rows)||void 0===t?void 0:t.length)?w.getRowModel().rows.map(e=>(0,s.jsx)(m,{"data-state":e.getIsSelected()&&"selected",className:"".concat(0===e.depth?"":"bg-muted"),children:e.getVisibleCells().map(e=>(0,s.jsx)(h,{children:(0,a.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,s.jsx)(m,{children:(0,s.jsx)(h,{colSpan:l.length,className:"h-24 text-center",children:"No results."})})})]})})})}h.displayName="TableCell",r.forwardRef((e,t)=>{let{className:l,...r}=e;return(0,s.jsx)("caption",{ref:t,className:(0,i.cn)("mt-4 text-sm text-muted-foreground",l),...r})}).displayName="TableCaption"},8449:function(e,t,l){"use strict";l.d(t,{z:function(){return g}});var s=l(3827),r=l(585),a=l(8886),n=l(5479),i=l(2177),o=l(4090),c=l(7392),d=l(2169);let m=c.zt,x=c.fC,h=c.xz,u=o.forwardRef((e,t)=>{let{className:l,sideOffset:r=4,...a}=e;return(0,s.jsx)(c.VY,{ref:t,sideOffset:r,className:(0,d.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",l),...a})});u.displayName=c.VY.displayName;let g=[{accessorKey:"label",header:e=>{let{column:t}=e;return(0,s.jsxs)(a.z,{variant:"ghost",onClick:()=>t.toggleSorting("asc"===t.getIsSorted()),children:["Name",(0,s.jsx)(r.Z,{className:"ml-2 h-4 w-4"})]})},cell:e=>{let{row:t}=e;return(0,s.jsxs)("div",{className:"".concat(0===t.depth?"ml-4 flex items-center":"ml-8"),children:[0===t.depth&&(t.original.label||t.original.name)||t.original.url," ",0===t.depth&&t.original.description&&(0,s.jsx)(m,{children:(0,s.jsxs)(x,{children:[(0,s.jsx)(h,{children:(0,s.jsx)(i.pjG,{className:"ml-2 h-4 w-4 text-muted-foreground"})}),(0,s.jsx)(u,{children:t.original.description})]})}),t.getCanExpand()?(0,s.jsx)("button",{onClick:t.getToggleExpandedHandler(),className:"ml-2",style:{cursor:"pointer"},children:t.getIsExpanded()?(0,s.jsx)(i.v4q,{}):(0,s.jsx)(i.XCv,{})}):""]})}},{accessorKey:"status",header:e=>{let{column:t}=e;return(0,s.jsxs)(a.z,{variant:"ghost",onClick:()=>t.toggleSorting("asc"===t.getIsSorted()),children:["Status",(0,s.jsx)(r.Z,{className:"ml-2 h-4 w-4"})]})},cell:e=>{let{row:t}=e;if(t.original){let e="";switch(t.original.state){case"HEALTHY":case"AVAILABLE":e="#4CAF50";break;case"LIMITED":e="#FFDD44";break;default:e="#F44336"}return(0,s.jsx)(n.C,{className:"ml-4",style:{backgroundColor:e,color:"white",cursor:"default"},children:t.original.state})}return null}},{accessorKey:"message",header:e=>{let{column:t}=e;return(0,s.jsx)("div",{className:"flex items-center justify-start",children:(0,s.jsx)(a.z,{variant:"ghost",children:"Message"})})},cell:e=>{let{row:t,getValue:l}=e;return(0,s.jsx)("div",{className:"ml-4 flex items-center justify-start",children:l()})}},{accessorKey:"checked",header:e=>{let{column:t}=e;return(0,s.jsx)("div",{className:"flex items-center justify-start",children:(0,s.jsx)(a.z,{variant:"ghost",children:"Last checked"})})},cell:e=>{let{row:t,getValue:l}=e;return(0,s.jsx)("div",{className:"ml-4 flex items-center justify-start",children:l()})}}]},9062:function(e,t,l){"use strict";l.d(t,{Z:function(){return d}});var s=l(3827),r=l(9084),a=l(4090),n=l(6311),i=l(1632),o=l(2169);let c=a.forwardRef((e,t)=>{let{className:l,value:r,indicatorColor:a,...n}=e;return(0,s.jsx)(i.fC,{ref:t,className:(0,o.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",l),...n,children:(0,s.jsx)(i.z$,{className:"h-full w-full flex-1 transition-all ".concat(a),style:{transform:"translateX(-".concat(100-(r||0),"%)")}})})});function d(e){let{entity:t,tilesets:l,label:i,percent:o,startedAt:d,updatedAt:m,id:x,info:h}=e,u=d<=0?"waiting":m<=0?"starting":(0,n.Z)((m-d)*1e3),[g,f]=(0,a.useState)([]),p=e=>{f(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])};return(0,s.jsxs)(r.Zb,{className:"shadow-lg",style:{height:"250px",overflow:"auto",boxSizing:"border-box"},children:[(0,s.jsx)(r.Ol,{children:(0,s.jsx)(r.ll,{className:"text-2xl font-bold break-normal mb-5",children:(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,s.jsx)("div",{className:"flex-none ".concat(100===o?"text-green-500":"text-blue-500"),style:{width:"360px",marginRight:"90px",paddingRight:"60px",textAlign:"center"},children:i}),(0,s.jsx)("div",{children:t})]})})}),(0,s.jsxs)(r.aY,{className:"flex items-start",children:[(0,s.jsx)("div",{className:"text-xl font-bold break-normal",style:{width:"360px",marginRight:"90px"},children:(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:"flex flex-col justify-center items-center w-5/6 ".concat(100===o?"":"animate-pulse"," mt-1"),children:[(0,s.jsx)("div",{className:"text-center",style:{marginTop:"0px",marginBottom:"10px"},children:(0,s.jsx)("span",{children:u})}),(0,s.jsx)(c,{value:o,indicatorColor:"".concat(100===o?"bg-green-400":"bg-blue-400")}),(0,s.jsxs)("span",{className:"w-1/6 text-right mt-3",children:[o,"%"]})]})})}),(0,s.jsx)("div",{className:"flex flex-col w-[360px] mt-[-10px]",children:Object.keys(l).length>0&&(0,s.jsx)("div",{style:{marginRight:"225px",marginTop:"-18px",height:"50px",width:"100%"},children:Object.entries(l).map(e=>{let[t,l]=e;return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"row",color:"dimgray",fontSize:"14px",fontWeight:"bold",marginBottom:"10px"},children:[(0,s.jsx)("button",{onClick:()=>p("".concat(x," + ").concat(t)),style:{background:"none",border:"none",cursor:"pointer",marginRight:"5px",width:"20px",display:"flex",justifyContent:"center"},children:g.includes("".concat(x," + ").concat(t))?"▼":"▶"}),(0,s.jsx)("div",{style:{width:"300px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:"dimgray",fontSize:"14px",fontWeight:"bold",marginRight:"20px"},title:t,children:t}),l.progress&&void 0!==l.progress.percent&&(0,s.jsx)("div",{className:"flex flex-col justify-center items-center w-1/6 ".concat(100===l.progress.percent?"":"animate-pulse"," mt-1"),children:(0,s.jsx)(c,{value:l.progress.percent,indicatorColor:"".concat(100===l.progress.percent?"bg-green-400":"bg-blue-400")})})]},t),g.includes("".concat(x," + ").concat(t))&&l.progress&&l.progress.levels&&Object.keys(l.progress.levels).map(e=>(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"row",marginLeft:"35px",marginBottom:"5px",color:"#808080",fontSize:"12px",fontWeight:"bold",marginRight:"20px"},children:[(0,s.jsxs)("div",{children:[e,":\xa0\xa0"]}),l.progress&&l.progress.levels&&l.progress.levels[e].map((e,t)=>e>-1?(0,s.jsxs)("span",{className:"".concat(e>0?"animate-pulse":"text-green-400"),style:{marginRight:"5px"},children:[t,"\xa0"]},t):null)]},e))]},t)})})})]})]})}c.displayName=i.fC.displayName}},function(e){e.O(0,[310,606,547,6,267,647,721,800,672,971,69,744],function(){return e(e.s=9476)}),_N_E=e.O()}]);