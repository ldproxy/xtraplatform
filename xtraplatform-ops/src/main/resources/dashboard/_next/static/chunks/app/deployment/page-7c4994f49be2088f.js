(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[374],{548:function(e,t,s){Promise.resolve().then(s.bind(s,7605))},7605:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return E}});var l=s(3827),n=s(8449),r=s(2548),a=s(5600),i=s(9062),c=s(2177),o=s(9539),d=s.n(o),x=s(5744),m=s(2169),h=s(4090),u=s(3702),p=s(594),g=s(4691),f=s(6054),j=s.n(f);s(1209),s(7613);var y=s(7907),v=s(7780),b=s(8403),N=s(7134),w=s(5459),A=s(9275),I=s(2830),k=s(2172);function E(){let e=(0,I.useReloadInterval)(),[t,s]=(0,h.useState)("overview"),[o,f]=(0,h.useState)([]),E=(0,y.useRouter)(),S=(0,y.usePathname)(),[C,L]=(0,h.useState)([{name:"",url:"",apiUrl:[""],id:""}]),[O,R]=(0,h.useState)(""),[z,F]=(0,h.useState)(null),[U,B]=(0,h.useState)(!0),[D,H]=(0,h.useState)({id:"",name:"",apiUrl:[""]}),{entities:T,jobs:V,healthChecks:Z,metrics:_,info:P,values:M,cfg:Y,hasError:q,nodesDifferent:W,loadData:J}=(0,w.w)(D);(0,h.useEffect)(()=>{U&&C.length>0&&J().then(()=>B(!1))},[C]),(0,h.useEffect)(()=>{if(!U&&e>0){let t=setInterval(J,1e3*e);return()=>clearInterval(t)}},[U,e]),(0,h.useEffect)(()=>{k.hB&&((0,N.R_)().then(e=>{L(e),(0,N.nA)(e,R,H)}),(0,N.Ax)(R))},[]),(0,h.useEffect)(()=>{(async()=>{F(await G(Z))})()},[Z]),(0,h.useEffect)(()=>{let e=Object.values(Z).flat().filter(e=>e&&e.name&&e.name.startsWith("app/")&&"app/store/values2"!==e.name).map(e=>{if(e&&e.name){var t;let s=(null===(t=e.url.match(/\/\/([^\/]+)/))||void 0===t?void 0:t[1])||"";return{label:e.name.substring(4),url:s,state:e.state,checked:d()(e.timestamp).format("HH:mm:ss")}}return null}).filter(e=>null!==e);f((0,A.E8)(e))},[Z]),(0,h.useEffect)(()=>{S&&s(window.location.hash.slice(1)||"overview")},[S]);let K=()=>{let e=Object.keys(W).filter(e=>W[e]);return e.length>0?"Warning: Differences detected in ".concat(e.join(" and ")," across different replicas. This issue is likely temporary."):null},G=async e=>{if(!D||!(Object.keys(D).length>0))return null;{let t=e[D.name],s="";return t&&t.length>0?t.some(e=>"UNAVAILABLE"===e.state)?s="UNHEALTHY":t.every(e=>"AVAILABLE"===e.state)?s="HEALTHY":t.every(e=>"OFFLINE"===e.state)?s="OFFLINE":t.some(e=>"OFFLINE"===e.state)&&t.some(e=>"AVAILABLE"===e.state)&&(s="LIMITED"):s="OFFLINE",[{name:D.name,healthStatus:s}]}},X=o.length,Q=M.length,$=T.length,ee=(0,b.lY)(T),et=(0,b.Ph)(ee),es=[];return V.length>0&&(es=(0,m.b5)(V)),g.ke&&(console.log("Values:",Q),console.log("totalSources:",X),console.log("Jobs",V),console.log("autoRefreshInterval",e)),(0,l.jsxs)("div",{className:"flex-1 space-y-4 p-8 pt-0",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between space-y-2",children:[(0,l.jsx)("h2",{className:"text-2xl font-semibold tracking-tight",children:"Deployment"}),D&&Object.keys(D).length>0&&_&&_.some(e=>Array.isArray(e.metrics)&&e.metrics.some(e=>-1===e.uptime&&-1===e.memory))&&(0,l.jsx)("div",{className:"ml-auto",children:(0,l.jsx)(v.Z,{color:"#123abc",loading:!0,size:20})})]}),(0,l.jsxs)(x.mQ,{value:t,onValueChange:e=>{s(e),""!==O?E.push("".concat(S,"?did=").concat(O,"#").concat(e)):E.push("".concat(S,"#").concat(e))},className:"h-full space-y-6",children:[(0,l.jsx)("div",{className:"space-between flex items-center",children:(0,l.jsxs)(x.dr,{children:[(0,l.jsx)(x.SP,{value:"overview",children:(0,l.jsx)("span",{children:"Overview"})}),(0,l.jsx)(x.SP,{value:"store",children:(0,l.jsx)("span",{children:"Base Health"})}),(0,l.jsx)(x.SP,{value:"jobs",children:(0,l.jsx)("span",{children:"Jobs"})})]})}),K()&&(0,l.jsxs)("div",{className:"flex items-center space-x-2 p-4 bg-yellow-100 border border-yellow-400 text-yellow-700 rounded",children:[(0,l.jsx)(c.LPM,{className:"h-5 w-5"}),(0,l.jsx)("span",{children:K()})]}),(0,l.jsxs)(x.nU,{value:"overview",children:[(0,l.jsx)("div",{className:"grid gap-4 md:grid-cols-1 lg:grid-cols-1",style:{marginBottom:"10px"},children:D&&Object.keys(D).length>0&&_.length>0&&P.length>0&&T.length>0&&z&&z.length>0&&(()=>{var e;let t=P&&P.find(e=>e.name===D.name),s=_&&_.find(e=>e.name===D.name),n=z&&(null===(e=z.find(e=>e.name===D.name))||void 0===e?void 0:e.healthStatus);g.ke&&console.log("deploymentInfoEntity",t,"deploymentMetricsEntity",s,"deploymentHealthStatusEntity",n);let r=(0,l.jsx)(a.Z,{name:D&&D.name?" ".concat(D.name):"",versions:t&&Array.isArray(t.info)?t.info.filter(e=>"string"==typeof e.version).map(e=>({version:e.version,apiUrl:e.apiUrl})):[],uptimes:s&&Array.isArray(s.metrics)?s.metrics.filter(e=>"number"==typeof e.uptime).map(e=>({uptime:e.uptime,apiUrl:e.apiUrl})):[],memories:s&&Array.isArray(s.metrics)?s.metrics.filter(e=>"number"==typeof e.memory).map(e=>({memory:e.memory,apiUrl:e.apiUrl})):[],healthStatus:n&&"string"==typeof n?n:"",url:t&&Array.isArray(t.info)&&t.info.length>0&&"string"==typeof t.info[0].url?t.info[0].url:"",IconFooter1:(0,u.q)("Clock"),IconFooter2:(0,u.q)("Upload"),IconFooter3:(0,u.q)("Desktop"),className:"hover:bg-gray-100 transition-colors duration-200"},D.id);return"OFFLINE"===n?(0,l.jsx)("div",{children:r},D.id):r})()}),(0,l.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,l.jsx)(r.Z,{main:"Entities",route:"/entities".concat(""!==O?"?did=".concat(O):""),footer:et,total:$,Icon:(0,u.q)("Id")},"Entities"),(0,l.jsx)(r.Z,{main:"Values",route:"/values".concat(""!==O?"?did=".concat(O):""),footer:"\xa0",total:Q,Icon:(0,u.q)("Code")},"Values")]})]}),(0,l.jsx)(x.nU,{value:"store",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Health checks for global components that are used by all entities."}),(0,l.jsx)(p.w,{columns:n.z,data:o})]})}),(0,l.jsx)(x.nU,{value:"jobs",children:es.length>0?es.map(e=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"grid gap-4 md:grid-cols-1 lg:grid-cols-1",style:{marginBottom:"10px"},children:(0,l.jsx)(i.Z,{entity:e.entity,label:e.label,tilesets:e.details.tileSets,percent:e.percent,startedAt:e.startedAt,updatedAt:e.updatedAt,info:"".concat(e.current,"/").concat(e.total),id:e.id},e.id)}),(0,l.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4"})]})):(0,l.jsx)("span",{children:"Currently No Jobs"})}),(0,l.jsx)(x.nU,{value:"cfg",children:(0,l.jsx)("div",{style:{backgroundColor:"#f5f5f5",borderRadius:"8px",padding:"16px",border:"1px solid lightgray"},children:q?"No results.":0===Object.keys(Y).length?(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(v.Z,{color:"#123abc",loading:!0,size:20}),(0,l.jsx)("span",{style:{marginLeft:"5px"},children:"Loading..."})]}):Object.entries(Y).map(e=>{let[t,s]=e,n=JSON.stringify(s,null,2),r=j().highlight(n,j().languages.json,"json");return(0,l.jsxs)("div",{style:{display:"flex"},children:[(0,l.jsxs)("span",{children:[t,":"]}),(0,l.jsx)("pre",{dangerouslySetInnerHTML:{__html:r},style:{margin:"0 0 0 10px"}})]},t)})})})]})]})}},8449:function(e,t,s){"use strict";s.d(t,{z:function(){return p}});var l=s(3827),n=s(585),r=s(8886),a=s(5479),i=s(2177),c=s(4090),o=s(7392),d=s(2169);let x=o.zt,m=o.fC,h=o.xz,u=c.forwardRef((e,t)=>{let{className:s,sideOffset:n=4,...r}=e;return(0,l.jsx)(o.VY,{ref:t,sideOffset:n,className:(0,d.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r})});u.displayName=o.VY.displayName;let p=[{accessorKey:"label",header:e=>{let{column:t}=e;return(0,l.jsxs)(r.z,{variant:"ghost",onClick:()=>t.toggleSorting("asc"===t.getIsSorted()),children:["Name",(0,l.jsx)(n.Z,{className:"ml-2 h-4 w-4"})]})},cell:e=>{let{row:t}=e;return(0,l.jsxs)("div",{className:"".concat(0===t.depth?"ml-4 flex items-center":"ml-8"),children:[0===t.depth&&(t.original.label||t.original.name)||t.original.url," ",0===t.depth&&t.original.description&&(0,l.jsx)(x,{children:(0,l.jsxs)(m,{children:[(0,l.jsx)(h,{children:(0,l.jsx)(i.pjG,{className:"ml-2 h-4 w-4 text-muted-foreground"})}),(0,l.jsx)(u,{children:t.original.description})]})}),t.getCanExpand()?(0,l.jsx)("button",{onClick:t.getToggleExpandedHandler(),className:"ml-2",style:{cursor:"pointer"},children:t.getIsExpanded()?(0,l.jsx)(i.v4q,{}):(0,l.jsx)(i.XCv,{})}):""]})}},{accessorKey:"status",header:e=>{let{column:t}=e;return(0,l.jsxs)(r.z,{variant:"ghost",onClick:()=>t.toggleSorting("asc"===t.getIsSorted()),children:["Status",(0,l.jsx)(n.Z,{className:"ml-2 h-4 w-4"})]})},cell:e=>{let{row:t}=e;if(t.original){let e="";switch(t.original.state){case"HEALTHY":case"AVAILABLE":e="#4CAF50";break;case"LIMITED":e="#FFDD44";break;default:e="#F44336"}return(0,l.jsx)(a.C,{className:"ml-4",style:{backgroundColor:e,color:"white",cursor:"default"},children:t.original.state})}return null}},{accessorKey:"message",header:e=>{let{column:t}=e;return(0,l.jsx)("div",{className:"flex items-center justify-start",children:(0,l.jsx)(r.z,{variant:"ghost",children:"Message"})})},cell:e=>{let{row:t,getValue:s}=e;return(0,l.jsx)("div",{className:"ml-4 flex items-center justify-start",children:s()})}},{accessorKey:"checked",header:e=>{let{column:t}=e;return(0,l.jsx)("div",{className:"flex items-center justify-start",children:(0,l.jsx)(r.z,{variant:"ghost",children:"Last checked"})})},cell:e=>{let{row:t,getValue:s}=e;return(0,l.jsx)("div",{className:"ml-4 flex items-center justify-start",children:s()})}}]},9062:function(e,t,s){"use strict";s.d(t,{Z:function(){return d}});var l=s(3827),n=s(9084),r=s(4090),a=s(6311),i=s(1632),c=s(2169);let o=r.forwardRef((e,t)=>{let{className:s,value:n,indicatorColor:r,...a}=e;return(0,l.jsx)(i.fC,{ref:t,className:(0,c.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...a,children:(0,l.jsx)(i.z$,{className:"h-full w-full flex-1 transition-all ".concat(r),style:{transform:"translateX(-".concat(100-(n||0),"%)")}})})});function d(e){let{entity:t,tilesets:s,label:i,percent:c,startedAt:d,updatedAt:x,id:m,info:h}=e,u=d<=0?"waiting":x<=0?"starting":(0,a.Z)((x-d)*1e3),[p,g]=(0,r.useState)([]),f=e=>{g(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])};return(0,l.jsxs)(n.Zb,{className:"shadow-lg",style:{height:"250px",overflow:"auto",boxSizing:"border-box"},children:[(0,l.jsx)(n.Ol,{children:(0,l.jsx)(n.ll,{className:"text-2xl font-bold break-normal mb-5",children:(0,l.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,l.jsx)("div",{className:"flex-none ".concat(100===c?"text-green-500":"text-blue-500"),style:{width:"360px",marginRight:"90px",paddingRight:"60px",textAlign:"center"},children:i}),(0,l.jsx)("div",{children:t})]})})}),(0,l.jsxs)(n.aY,{className:"flex items-start",children:[(0,l.jsx)("div",{className:"text-xl font-bold break-normal",style:{width:"360px",marginRight:"90px"},children:(0,l.jsx)("div",{children:(0,l.jsxs)("div",{className:"flex flex-col justify-center items-center w-5/6 ".concat(100===c?"":"animate-pulse"," mt-1"),children:[(0,l.jsx)("div",{className:"text-center",style:{marginTop:"0px",marginBottom:"10px"},children:(0,l.jsx)("span",{children:u})}),(0,l.jsx)(o,{value:c,indicatorColor:"".concat(100===c?"bg-green-400":"bg-blue-400")}),(0,l.jsxs)("span",{className:"w-1/6 text-right mt-3",children:[c,"%"]})]})})}),(0,l.jsx)("div",{className:"flex flex-col w-[360px] mt-[-10px]",children:Object.keys(s).length>0&&(0,l.jsx)("div",{style:{marginRight:"225px",marginTop:"-18px",height:"50px",width:"100%"},children:Object.entries(s).map(e=>{let[t,s]=e;return(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{style:{display:"flex",flexDirection:"row",color:"dimgray",fontSize:"14px",fontWeight:"bold",marginBottom:"10px"},children:[(0,l.jsx)("button",{onClick:()=>f("".concat(m," + ").concat(t)),style:{background:"none",border:"none",cursor:"pointer",marginRight:"5px",width:"20px",display:"flex",justifyContent:"center"},children:p.includes("".concat(m," + ").concat(t))?"▼":"▶"}),(0,l.jsx)("div",{style:{width:"300px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:"dimgray",fontSize:"14px",fontWeight:"bold",marginRight:"20px"},title:t,children:t}),s.progress&&void 0!==s.progress.percent&&(0,l.jsx)("div",{className:"flex flex-col justify-center items-center w-1/6 ".concat(100===s.progress.percent?"":"animate-pulse"," mt-1"),children:(0,l.jsx)(o,{value:s.progress.percent,indicatorColor:"".concat(100===s.progress.percent?"bg-green-400":"bg-blue-400")})})]},t),p.includes("".concat(m," + ").concat(t))&&s.progress&&s.progress.levels&&Object.keys(s.progress.levels).map(e=>(0,l.jsxs)("div",{style:{display:"flex",flexDirection:"row",marginLeft:"35px",marginBottom:"5px",color:"#808080",fontSize:"12px",fontWeight:"bold",marginRight:"20px"},children:[(0,l.jsxs)("div",{children:[e,":\xa0\xa0"]}),s.progress&&s.progress.levels&&s.progress.levels[e].map((e,t)=>e>-1?(0,l.jsxs)("span",{className:"".concat(e>0?"animate-pulse":"text-green-400"),style:{marginRight:"5px"},children:[t,"\xa0"]},t):null)]},e))]},t)})})})]})]})}o.displayName=i.fC.displayName},2548:function(e,t,s){"use strict";s.d(t,{Z:function(){return o}});var l=s(3827),n=s(8792),r=s(9084),a=s(2177),i=s(5479);let c=e=>{let{footer:t}=e,s=t.includes("/")?t.split("/")[1]:t.includes("OGC_API")?t:null;return(0,l.jsx)(l.Fragment,{children:t?t.split(" ").map((e,t,n)=>"available"!==e||isNaN(Number(n[t-1]))?"limited"!==e||isNaN(Number(n[t-1]))?"unavailable"!==e||isNaN(Number(n[t-1]))?null!==s?(0,l.jsx)(i.C,{variant:"secondary",children:s},s):isNaN(Number(e))||"available"!==n[t+1]&&"unavailable"!==n[t+1]&&"limited"!==n[t+1]?e+" ":null:[(0,l.jsxs)("span",{className:"text-destructive mr-2",style:{display:"flex",alignItems:"center",marginRight:"15px",fontSize:"20px"},title:"".concat(n[t-1]," ").concat(e),children:[(0,l.jsx)(a.xrR,{className:"text-destructive",width:"20px",height:"20px",style:{marginRight:"5px"}},"CheckCircledIcon"),n[t-1]]},t)]:[(0,l.jsxs)("span",{className:"text-warning mr-2",style:{display:"flex",alignItems:"center",marginRight:"15px",fontSize:"20px"},title:"".concat(n[t-1]," ").concat(e),children:[(0,l.jsx)(a.LPM,{className:"text-warning",width:"20px",height:"20px",style:{marginRight:"5px"}},"CheckCircledIcon"),n[t-1]]},t)]:[(0,l.jsxs)("span",{className:"text-success mr-2",style:{display:"flex",alignItems:"center",marginRight:"15px",fontSize:"20px"},title:"".concat(n[t-1]," ").concat(e),children:[(0,l.jsx)(a.NhS,{className:"text-success",width:"20px",height:"20px",style:{marginRight:"5px"}},"CheckCircledIcon"),n[t-1]]},t)]):null})};function o(e){let{header:t,main:s,footer:a,route:i,total:o,Icon:d,...x}=e,m="AVAILABLE"===t||"ACTIVE"===t||"true"===t?"text-success":"LIMITED"===t?"text-warning":"UNAVAILABLE"===t||"false"===t?"text-destructive":"text-blue-700";return(0,l.jsx)(n.default,{href:i||"#",children:(0,l.jsxs)(r.Zb,{className:"shadow-lg hover:bg-gray-100 transition-colors duration-200",style:{height:"140px"},...x,children:[(0,l.jsx)(r.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-0",children:(0,l.jsx)(r.ll,{className:"text-sm font-semibold ".concat(m).concat(t?"":"text-2xl font-bold mb-1"),children:t?(0,l.jsx)("span",{className:"text-1xl font-bold mb-1 inline-block",children:t}):(0,l.jsx)("span",{className:"text-2xl font-bold mb-1 mt-[-20px] inline-block",children:o})})}),(0,l.jsxs)(r.aY,{children:[(0,l.jsxs)("div",{className:"text-2xl font-bold",style:{display:"flex",flexDirection:"row",marginBottom:"5px",alignItems:"center",justifyContent:"flex-start",gap:"10px"},children:[d?(0,l.jsx)(d,{className:"h-6 w-6 text-muted-foreground"}):null,(0,l.jsx)("span",{style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},title:"string"==typeof s?s:"",children:s})]}),(0,l.jsx)("div",{style:{display:"flex",flexWrap:"wrap"},children:(0,l.jsx)("p",{className:"text-xs text-muted-foreground",style:{display:"flex",flexDirection:"row",marginTop:"5px"},children:a?(0,l.jsx)(c,{footer:a}):null})})]})]})})}}},function(e){e.O(0,[310,606,547,6,267,647,721,800,672,600,971,69,744],function(){return e(e.s=548)}),_N_E=e.O()}]);